<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html 
PUBLIC "-//W3C//DTD XHTML 1.1//EN"
       "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><title>Evaluation By Pattern | Inclusive Design Patterns</title><link rel="stylesheet" href="css/book.css" type="text/css"/><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><meta name="EPB-UUID" content="24CC751A-5435-483D-851C-00DC23A33E17"/></head><body><div class="body"><h1>Evaluation By Pattern</h1><p>When I started working on this book, I prepared a rough outline first. This skeleton was organized around theme, or principle. That is, I had a chapter stubbed out about keyboard interaction, one about color, another on writing, and so on.</p><p>It&#8217;s good to be prepared, but better to be prepared in the right way. As I embarked on fleshing out the various chapters, it quickly became apparent that I&#8217;d wrong-footed the structure entirely. It just wasn&#8217;t compatible with the way I instinctively think and work.</p><p>The trouble was, when I set about describing how to make something keyboard-accessible, I had to bite my tongue not to talk about touch interaction, screen reader compatibility and copywriting as well. It didn&#8217;t feel right to expound on making something inclusive in one regard without taking care of all the other problems that might undermine the same example. I&#8217;d be leaving the job unfinished.</p><p>When we design interfaces, we don&#8217;t deal in abstract principles, we create working <em>things</em>. Our terminology for these things fluctuates between <em>modules</em>, <em>components</em>, or the looser term <em>patterns</em>, but essentially we mean the parts that contribute to an interface.</p><p>When creating patterns, we don&#8217;t labor according to any one guiding principle; we don&#8217;t create keyboard-accessible patterns or internationalized patterns. We want these patterns to have <em>all</em> the good qualities and, of course, none of the bad ones.</p><p>I ditched the contrived inclusion-by-principle structure early on in favor of talking through discrete patterns &mdash; motifs and components you might find in a working website or application. My writing began to flow much more easily because I was essentially documenting my design process: the work of conceiving and realizing inclusive content and functionality. Since I&#8217;m speaking to you as designers, developers and makers yourselves, I figured this would make for clearer and more transferable information for you too.</p><h2>The Problem With Evaluating By Principle</h2><p>The reason I started out writing by principle is because I often have to wear my accessibility engineer hat and perform accessibility audits. I evaluate the accessibility of a website or application, identifying problems and offering guidance for remediation: making things unbroken.</p><p>When performing an audit, I defer to WCAG (Web Content Accessibility Guidelines). Though different countries have their own accessibility legislation, WCAG offers the de facto international rule set and is ratified by the W3C standards body. On the whole, it&#8217;s better I don&#8217;t <em>just</em> tell folks how <em>I</em> think they should have designed their interface!</p><p>That WCAG is organized by principle &mdash; <em>perceivable</em>, <em>operable</em>, <em>understandable</em>, <em>robust</em> &mdash; is to be expected. WCAG doesn&#8217;t know in advance precisely which elements, composites and conventions you are going to employ so it has to remain abstract. However, this has led manual evaluation experts and automated test tools to <em>report</em> according to principle.</p><p>We&#8217;re fairly wedded to reporting accessibility failures by principle because it&#8217;s easier that way to reassure ourselves each and every independent issue has been covered. I&#8217;m just not convinced development teams find information presented in this way easily actionable. When developer focus moves between integrated components, what good are a hundred disparate and application-wide missing alternative text tickets?</p><p><img src="images/alt_text_tickets.png" alt="A list of tickets tagged with the bug keyword with titles like ‘Bad alt text on page 76’ and ‘Missing alt text on page 94.’" /><br /><em>SIGH! Time to put the headphones on and fire up some Napalm Death.</em></p><p>But that&#8217;s not all. A lot of the time, one issue apparently belonging to one principle or theme is related &mdash; either by cause or correlation &mdash; to another. Contriving to turn one instance of poor design into two or more reported issues not only complicates the remediation process, but does nothing to educate the developer about how these problems really come about.</p><h3>The Button Example (Again)</h3><p>Let&#8217;s take another look at the button example from the book&#8217;s introduction. Except this time let&#8217;s imagine the faux button is for upvoting some content.</p><p>The button markup looks like this:</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span> <span class="token attr-name">data-action</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre><p>And the button appears like so:</p><p><img src="images/upvote_button.png" alt="Button shape with a thumbs-up icon to the left and the word ‘upvote’ with an exclamation mark to the right." /></p><p>The separation between style and behavior between the <code>class</code> and <code>data-action</code> attributes is nice and all, but it hardly makes up for the button&#8217;s grave shortcomings when it comes to inclusion.</p><p>This time, let&#8217;s map those shortcomings to WCAG&#8217;s success criteria to establish where there are failings. First, under <em>perceivable</em>, the button fails <a href="https://www.w3.org/TR/WCAG20/#text-equiv"><span class="link">1.1.1 Non-text Content</span></a><sup><a href="#fn14_1"><span class="sup_link">1</span></a></sup> because it has no alternative text to supplement the image of text in the background. Second, under <em>operable</em>, it fails <a href="https://www.w3.org/TR/WCAG20/#keyboard-operation"><span class="link">2.1.1 Keyboard</span></a><sup><a href="#fn14_2"><span class="sup_link">2</span></a></sup> because the button uses an unfocusable <code>&lt;div&gt;</code> element, which &mdash; even if you made it to be focusable with <code>tabindex="0"</code> &mdash; would still need some JavaScript to trigger click events on pressing the <em>Enter</em> and <em>Space</em> keys. Finally, under <em>robust</em>, the button fails <a href="https://www.w3.org/TR/WCAG20/#ensure-compat"><span class="link">4.1.2 Name, Role, Value</span></a><sup><a href="#fn14_3"><span class="sup_link">3</span></a></sup> because there&#8217;s nothing in the markup to communicate in assistive technologies that the button is, indeed, a button.</p><h3>Fixing the Button</h3><p>Now imagine an accessibility consultant has reported all of these failures in a spreadsheet under columns organized by principle and success criterion. This spreadsheet is then handed off to their client&#8217;s project manager who sets about writing bug tickets for the developers.</p><p>One developer is randomly assigned a ticket labeled &#8220;Upvote Button Missing Label.&#8221; They open that ticket and, like any self-respecting developer, endeavor to fix and close it. Not especially familiar with accessible naming techniques, they do a bit of casual research and land on some possible solutions. Supplying a text node is out because this would be visible over the top of the background image&#8217;s text. In the end, they opt for <code>aria-label</code>.</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span> <span class="token attr-name">data-action</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre><p>Unknown to this developer, another developer is assigned &#8220;Upvote Button Not Keyboard-Accessible.&#8221; The ticket comes with some guidance from the accessibility consultant about how to make the <code>&lt;div&gt;</code> keyboard-accessible using <code>tabindex</code> and some JavaScript to trigger click events with the keyboard. The project&#8217;s JavaScript swells slightly and the markup ends up like this:</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span> <span class="token attr-name">data-action</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span> <span class="token attr-name">tabindex</span><span class="token attr-value"><span class="token punctuation">=</span>"0"</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre><p>Meanwhile, a third developer is dutifully studying &#8220;Upvote Button Has Improper Role&#8221; and &mdash; seeing how much work has gone into this <code>&lt;div&gt;</code> already &mdash; tops it off with an explicit ARIA role of <code>"button"</code>.</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span> <span class="token attr-name">data-action</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span> <span class="token attr-name">tabindex</span><span class="token attr-value"><span class="token punctuation">=</span>"0"</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation">=</span>"button"</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre><h3>A Better Way</h3><p>The problem with this contrived and fragmented way of evaluating interfaces is that nobody has the chance to point out and avoid what are simply <em>bad ideas</em>, like using a <code>&lt;div&gt;</code> as a button control. The way failures are reported and developers are tasked means you always end up just patching what&#8217;s already there. What you end up with is frequently bloated and less robust.</p><p>In reporting by pattern instead, the consultant has the opportunity to recommend alternative approaches and techniques. In this case, the various failures organized under the <em>upvote button pattern</em> would surely lead them to recommend the use of a standard <code>&lt;button&gt;</code> button element in its place.</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">data-action</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></code></pre><p>To complete the redesigned pattern they might recommend the use of an SVG to represent the icon. As I cover in &#8220;A Menu Button,&#8221; SVG benefits from being scalable, small in file size and &mdash; unlike icon fonts &mdash; not breakable by user font preferences.</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">data-action</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation">=</span>"upvote"</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span>"#upvote"</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>use</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></code></pre><p>To a developer used to working in terms of modules and components, this represents a complete, integrated solution to a problem. The accessibility consultant (reporter) has met them on their home turf and helped them to improve the interface in an apprehensible and tangible way.</p><p>But that&#8217;s not all. Because the inclusive upvote button replaces the previous implementation one-for-one, the consultant has also helped the organization improve its pattern library. The next time an upvote button (or similar) is needed, the developer has an exemplar at the ready. This could apply to current or future projects.</p><p><img src="images/enhancement_tickets.png" alt="Tickets tagged ‘Enhancement’ and named after patterns, not just problems." /><br /><em>Tickets organized by pattern can be easily reconciled with a pattern library.</em></p><p>As Joe Dolson writes in &#8220;<a href="https://www.joedolson.com/2016/01/im-an-accessibility-consultant-stop-hiring-me/"><span class="link">I&#8217;m an accessibility consultant. Stop hiring me</span></a><sup><a href="#fn14_4"><span class="sup_link">4</span></a></sup>,&#8221; remediating broken websites and apps is unpleasant work for both the consultant and the client. Much more effective and rewarding is training and education in how to <em>design</em> inclusive products from the outset. Remediating by pattern brings design thinking into the remediation process, helping the client to fix their current product while instilling the confidence to make inclusive design decisions in the future.</p><p>This is an effective way to make my role as a remediator obsolete and, like Joe, I welcome it.</p><h2>Custom Elements And Shadow DOM</h2><p>This is probably as good a place as any to approach the issue of inclusion and web components. Since many organizations are beginning to embrace the <a href="https://github.com/w3c/webcomponents"><span class="link">web component specifications</span></a><sup><a href="#fn14_5"><span class="sup_link">5</span></a></sup> to compose their patterns, we should look at what needs to be done differently or additionally in terms of inclusive design. Of the Shadow DOM, Custom Elements, HTML elements, and HTML templates specifications, only <a href="https://w3c.github.io/webcomponents/spec/custom/"><span class="link">Custom Elements</span></a><sup><a href="#fn14_6"><span class="sup_link">6</span></a></sup> and (to a lesser extent) <a href="https://w3c.github.io/webcomponents/spec/shadow/"><span class="link">Shadow DOM</span></a><sup><a href="#fn14_7"><span class="sup_link">7</span></a></sup> directly pose potential problems. Only they affect the behavior of the interface as it is manipulated by the user.</p><p>The joy of custom elements is that you can tie custom style and behavior to an element of your own conception. You could, for example, write all the code for a toggle button and attach it to a <code>&lt;toggle-button&gt;</code> element: a neat package of functionality with a descriptive name.</p><pre><code class="language-javascript"><span class="token comment">// Custom Elements v0 syntax
</span>document<span class="token punctuation">.</span>registerElement<span class="token punctuation">(</span><span class="token string">'toggle-button'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  prototype<span class="token punctuation">:</span> toggleButton
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">
// Custom Elements v1 syntax
</span>customElements<span class="token punctuation">.</span>define<span class="token punctuation">(</span><span class="token string">'toggle-button'</span><span class="token punctuation">,</span> toggleButton<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>(<strong>Note:</strong> For a comparison of Custom Elements versions 0 and 1, see Shawn Allen&#8217;s &#8220;<a href="https://github.com/shawnbot/custom-elements"><span class="link">All about HTML Custom Elements</span></a><sup><a href="#fn14_8"><span class="sup_link">8</span></a></sup>.&#8221;)</p><p>That new element, although accepted as a legitimate element in browsers supporting <code>registerElement</code> or <code>customElements.define</code>, does not have the standard behaviors of a <code>&lt;button&gt;</code> element. To put it another way, it is not an instance of the <a href="https://developer.mozilla.org/en/docs/Web/API/HTMLButtonElement"><span class="link"><code>HTMLButtonElement</code></span></a><sup><a href="#fn14_9"><span class="sup_link">9</span></a></sup> prototype. In fact, it is merely an instance of <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement"><span class="link"><code>HTMLElement</code></span></a><sup><a href="#fn14_10"><span class="sup_link">10</span></a></sup>, much like a <code>&lt;div&gt;</code>.</p><p>If you&#8217;ve been following along, you&#8217;ll know what that means: it&#8217;s not focusable or actionable, and doesn&#8217;t have the <code>button</code> role that announces it as a button in screen readers &mdash; just like the remediated <code>&lt;div&gt;</code> button I was talking about earlier in the chapter.</p><p>In the case of our custom element, these features can be added much more neatly and robustly. Using Custom Elements v0, we add them in the <a href="http://www.html5rocks.com/en/tutorials/webcomponents/customelements/#lifecycle"><span class="link"><code>createdCallback</code> lifecycle callback</span></a><sup><a href="#fn14_11"><span class="sup_link">11</span></a></sup>:</p><pre><code class=" language-javascript">toggleButton<span class="token punctuation">.</span>createdCallback <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// accept keyboard focus
</span>    this<span class="token punctuation">.</span>setAttribute<span class="token punctuation">(</span><span class="token string">'tabindex'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// make this element appear as a button in the accessibility tree
</span>    this<span class="token punctuation">.</span>setAttribute<span class="token punctuation">(</span><span class="token string">'role'</span><span class="token punctuation">,</span> <span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// start in non pressed state
</span>    this<span class="token punctuation">.</span>addEventListener<span class="token punctuation">(</span><span class="token string">'keydown'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">13</span> <span class="token operator">||</span> event<span class="token punctuation">.</span>keyCode <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> click <span class="token operator">=</span> <span class="token keyword">new</span> MouseEvent<span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token string">'view'</span><span class="token punctuation">:</span> this<span class="token punctuation">.</span>ownerDocument<span class="token punctuation">.</span>defaultView<span class="token punctuation">,</span>
                <span class="token string">'bubbles'</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token string">'cancelable'</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            this<span class="token punctuation">.</span>dispatchEvent<span class="token punctuation">(</span>click<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Since our toggle button will initialize in the off (unpressed) state, we should also add <code>aria-pressed="false"</code>:</p><pre><code class=" language-javascript">this<span class="token punctuation">.</span>setAttribute<span class="token punctuation">(</span><span class="token string">'aria-pressed'</span><span class="token punctuation">,</span> <span class="token string">'false'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>The advantage of adding these attributes and behaviors as part of the element&#8217;s definition is that the interface remains clean to authors &mdash; they only have to instantiate <code>&lt;toggle-button&gt;</code>. All we need to do now is handle that <code>click</code> event to switch the state. First we add the listener by placing this inside the <code>createdCallback</code> too:</p><pre><code class=" language-javascript">this<span class="token punctuation">.</span>addEventListener<span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  this<span class="token punctuation">.</span>toggle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Then we need to create the actual <code>toggle()</code> method. With the following in place, the state will change either on <code>click</code> or by scripting <code>toggleInstance.toggle()</code> (where <code>toggleInstance</code> is an instance of <code>&lt;toggle-button&gt;</code>).</p><pre><code class=" language-javascript">this<span class="token punctuation">.</span>toggle <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> isPressed <span class="token operator">=</span> this<span class="token punctuation">.</span>getAttribute<span class="token punctuation">(</span><span class="token string">'aria-pressed'</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'true'</span><span class="token punctuation">;</span>
    this<span class="token punctuation">.</span>setAttribute<span class="token punctuation">(</span><span class="token string">'aria-pressed'</span><span class="token punctuation">,</span> String<span class="token punctuation">(</span><span class="token operator">!</span>isPressed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>In terms of semantics and behavior, our <code>&lt;toggle-button&gt;</code> now has all the accessibility provisions of <code>&lt;button&gt;</code>, but also the toggle functionality which makes it deserving of its own element definition. In the tradition of <code>&lt;button&gt;</code> we have created an element which has accessibility <em>built in</em>, meaning it can simply be deployed to an interface without having to consider keyboard and screen reader inclusion as separate concerns.</p><p>Here&#8217;s a <a href="http://codepen.io/heydon/pen/ZOqwqQ"><span class="link">demo of this little toggle button implementation, using Custom Elements v0</span></a><sup><a href="#fn14_12"><span class="sup_link">12</span></a></sup>.</p><p>An easier way to get the basic functionality of a <code>&lt;button&gt;</code> before extending it is to literally <em>extend</em> the <code>HTMLButtonElement</code> prototype. Using Custom Elements v1 with ES2015/ES6 syntax, we can write what follows. Note that in Custom Elements v1, <code>createdCallback</code> is not necessary:</p><pre><code class=" language-javascript">class ToggleButton extends HTMLButtonElement <span class="token punctuation">{</span>
  constructor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    this<span class="token punctuation">.</span>setAttribute<span class="token punctuation">(</span><span class="token string">'aria-pressed'</span><span class="token punctuation">,</span> <span class="token string">'false'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token punctuation">.</span>toggle <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> isPressed <span class="token operator">=</span> this<span class="token punctuation">.</span>getAttribute<span class="token punctuation">(</span><span class="token string">'aria-pressed'</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'true'</span><span class="token punctuation">;</span>
      this<span class="token punctuation">.</span>setAttribute<span class="token punctuation">(</span><span class="token string">'aria-pressed'</span><span class="token punctuation">,</span> String<span class="token punctuation">(</span><span class="token operator">!</span>isPressed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    this<span class="token punctuation">.</span>addEventListener<span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      this<span class="token punctuation">.</span>toggle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

customElements<span class="token punctuation">.</span>define<span class="token punctuation">(</span><span class="token string">"toggle-button"</span><span class="token punctuation">,</span> ToggleButton<span class="token punctuation">,</span> <span class="token punctuation">{</span> extends<span class="token punctuation">:</span> <span class="token string">"button"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>As you can see, now that I&#8217;m piggybacking the <code>HTMLButtonElement</code>, I have been able to exclude the <code>tabindex</code> and <code>role</code> attributes, as well as the ugly <code>keydown</code> event dispatching script. We are doing as we set out to do from the very beginning: using what&#8217;s already at our disposal. It&#8217;s more reliable, efficient, and just plain easier.</p><h3>Shadow Boundary Issues</h3><p>For the most part, creating inclusive web components is just creating accessible, semantic HTML as usual but inside a new API. Two notable differences I&#8217;m aware of are the effect the shadow boundary (the boundary between the DOM and Shadow DOM) has on <a href="https://www.w3.org/TR/wai-aria/states_and_properties#attrs_relationships_header"><span class="link">ARIA relationship attributes</span></a><sup><a href="#fn14_13"><span class="sup_link">13</span></a></sup>, and positive <code>tabindex</code> values.</p><p>As Steve Faulkner writes in &#8220;<a href="https://www.paciellogroup.com/blog/2014/03/stuff-doesnt-work-dom-shadow-dom/"><span class="link">Some stuff that doesn&#8217;t work between the DOM and Shadow DOM</span></a><sup><a href="#fn14_14"><span class="sup_link">14</span></a></sup>,&#8221; the shadow boundary effectively severs relationships built using attributes like <code>aria-labelledby</code>, <code>aria-describedby</code> and <code>aria-controls</code>, where one element in the relationship is the other side of a shadow boundary.</p><p>There are common misconceptions that all custom elements have shadow DOM included, and that you can only use Shadow DOM with Custom Elements. No: they&#8217;re autonomous technologies. The toggle button example does not use Shadow DOM, so could still associate itself with an element of ID <code>#toggleTarget</code> using <code>aria-controls="toggleTarget"</code>. Nonetheless, if it did employ Shadow DOM, this would become impossible.</p><p>As for <code>tabindex</code>, using a positive integer like <code>tabindex="4"</code> will refer to the fourth in focus order within the shadow DOM and <em>not</em> the fourth in focus order within the parent document. This may have some useful applications, but use of explicit  <code>tabindex</code> ordering is not advised in any case. Focus order should follow source order for logical keyboard operation. This is most easily achieved simply by using implicitly focusable elements and &mdash; where necessary &mdash; elements with <code>tabindex="0"</code>. Both of which are placed in default focus order according to source order, unaffected by Shadow DOM subtrees.</p><div class="fn_overview"><p class="separator">—</p><p id="fn14_1"><span class="fn_number">1.</span><a href="https://www.w3.org/TR/WCAG20/#text-equiv"><span class="fn_link">https://www.w3.org/TR/WCAG20/#text-equiv</span></a></p><p id="fn14_2"><span class="fn_number">2.</span><a href="https://www.w3.org/TR/WCAG20/#keyboard-operation"><span class="fn_link">https://www.w3.org/TR/WCAG20/#keyboard-operation</span></a></p><p id="fn14_3"><span class="fn_number">3.</span><a href="https://www.w3.org/TR/WCAG20/#ensure-compat"><span class="fn_link">https://www.w3.org/TR/WCAG20/#ensure-compat</span></a></p><p id="fn14_4"><span class="fn_number">4.</span><a href="https://www.joedolson.com/2016/01/im-an-accessibility-consultant-stop-hiring-me/"><span class="fn_link">https://www.joedolson.com/2016/01/im-an-accessibility-consultant-stop-hiring-me/</span></a></p><p id="fn14_5"><span class="fn_number">5.</span><a href="https://github.com/w3c/webcomponents"><span class="fn_link">https://github.com/w3c/webcomponents</span></a></p><p id="fn14_6"><span class="fn_number">6.</span><a href="https://w3c.github.io/webcomponents/spec/custom/"><span class="fn_link">https://w3c.github.io/webcomponents/spec/custom/</span></a></p><p id="fn14_7"><span class="fn_number">7.</span><a href="https://w3c.github.io/webcomponents/spec/shadow/"><span class="fn_link">https://w3c.github.io/webcomponents/spec/shadow/</span></a></p><p id="fn14_8"><span class="fn_number">8.</span><a href="https://github.com/shawnbot/custom-elements"><span class="fn_link">https://github.com/shawnbot/custom-elements</span></a></p><p id="fn14_9"><span class="fn_number">9.</span><a href="https://developer.mozilla.org/en/docs/Web/API/HTMLButtonElement"><span class="fn_link">https://developer.mozilla.org/en/docs/Web/API/HTMLButtonElement</span></a></p><p id="fn14_10"><span class="fn_number">10.</span><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement"><span class="fn_link">https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement</span></a></p><p id="fn14_11"><span class="fn_number">11.</span><a href="http://www.html5rocks.com/en/tutorials/webcomponents/customelements/#lifecycle"><span class="fn_link">http://www.html5rocks.com/en/tutorials/webcomponents/customelements/#lifecycle</span></a></p><p id="fn14_12"><span class="fn_number">12.</span><a href="http://codepen.io/heydon/pen/ZOqwqQ"><span class="fn_link">http://codepen.io/heydon/pen/ZOqwqQ</span></a></p><p id="fn14_13"><span class="fn_number">13.</span><a href="https://www.w3.org/TR/wai-aria/states_and_properties#attrs_relationships_header"><span class="fn_link">https://www.w3.org/TR/wai-aria/states_and_properties#attrs_relationships_header</span></a></p><p id="fn14_14"><span class="fn_number">14.</span><a href="https://www.paciellogroup.com/blog/2014/03/stuff-doesnt-work-dom-shadow-dom/"><span class="fn_link">https://www.paciellogroup.com/blog/2014/03/stuff-doesnt-work-dom-shadow-dom/</span></a></p></div></div></body></html>
