<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xml:lang="ja" xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8" /><title>6章：ナビゲーション領域</title><link rel="stylesheet" href="css/book.css" type="text/css"/><meta name="EPB-UUID" content="f9202370-6e5d-44d5-b924-02b34d51163d"/></head><body><div class="body"><h1>6章：ナビゲーション領域</h1><p>これまでの章ではコンテンツに重点を置いたパターンを取り上げ、その管理や書き方などを学びました。しかし、Webページに含まれる内容は、本当の意味でのコンテンツだけではありません。たとえばナビゲーションの目印は、ユーザーがWebページ間を移動したり、コンテンツ内を移動するのに使用されます。つまり、ナビゲーションの目印は<em>メタ</em>的な、コンテンツを補助するコンテンツといえます。</p><p>ナビゲーション領域は長い歴史がある道具で、インクルーシブなページデザインに役立つ、ひとつの慣習として確立されています。それどころか、<a href="http://info.cern.ch/hypertext/WWW/TheProject.html"><span class="link">世界で初めて作られたWebページ</span></a>にさえ、定義リスト（<code>&lt;dl&gt;</code>）内の一連のリンクによって構成された原始的なナビゲーション領域が存在しました。この章では、サイト全体で共通して使われるナビゲーションパターンのデザインと、個別のページにおける目次の構成について学びます。構造化されたマークアップ、明確なラベル、堅牢なCSSの書き方についても触れます。ナビゲーション上の現在地をインクルーシブに示す方法――自分が今どこにいるかが誰でもわかるもの！――についても説明します。</p>
<div class="translator_note" id="translator_note1546"><h2>訳註</h2><p>dl要素は現在ではassociation listもしくはdescription listとされていますが、これはHTML5で再定義されたものです。最初期にはA glossary (or definition list)と定義されており、当時の呼び名としては「定義リスト」でも間違いではありません。</p><h3>参考</h3><ul><li><a href="https://www.w3.org/MarkUp/draft-ietf-iiir-html-01.txt">Hypertext Markup Language (HTML)</a></li></ul></div>
<h2>ナビゲーションランドマーク</h2><p>Webページの各部は箱型に区切られ、それぞれのエリアは<em>領域</em>、<em>ブロック</em>、<em>モジュール</em>などさまざまな名で呼ばれます。WAI-ARIAの仕様では、<code>role="main"</code>などいくつかの<a href="https://www.w3.org/TR/wai-aria-1.1/#landmark_roles"><span class="link">ランドマークロール</span></a>が用意されており、Webサイトで一般的に使われる領域に対して、支援技術でアクセシブルにするためのセマンティクスとふるまいを定義することができます。</p><p><code>&lt;main&gt;</code>要素と<code>role="main"</code>WAI-ARIAロールは相互にマッピングされており、同じセマンティクスとふるまいを提供します。どちらを使ってもかまいませんが、次の例からもわかるように、<code>&lt;main&gt;</code>の方が簡潔です。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation">=</span>"main"</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span>"main"</span><span class="token punctuation">&gt;</span></span>
    …
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- または…… --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span>"main"</span><span class="token punctuation">&gt;</span></span>
    …
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span></code></pre><p>インクルージョンのために、ナビゲーション領域もnavigation<em>ランドマーク</em>とすべきです。navigationランドマークは、<code>role="navigation"</code> WAI-ARIAロールまたは<code>&lt;nav&gt;</code>要素として示されますが、mainランドマークと異なるポイントが2つあります。</p><ul><li>navigationランドマークは1つのページに複数あってもよい。</li><li>navigationランドマーク内のコンテンツがWebサイト内の複数のページに出現する場合（共通のサイトナビゲーションブロックなど）、各ページ間で一貫した内容になっているべきである。</li></ul><h2>サイト内共通のナビゲーション</h2><p>まずは最も一般的なタイプのnavigationランドマークを見ていきつつ、すべてのnavigationランドマークに共通するいくつかの特徴を確かめてみましょう。</p><p>アクセシブルUX、プログレッシブエンハンスメント、後方互換性の観点から、ランドマーク領域にはリンクのリストを含めるべきです。<em>サイト</em>ナビゲーションとして、このリンクリストはサイトやアプリケーション内のさまざまなページで使われることになるでしょう。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/"</span><span class="token punctuation">&gt;</span></span>ホーム<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/about"</span><span class="token punctuation">&gt;</span></span>企業情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/products"</span><span class="token punctuation">&gt;</span></span>製品情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/contact"</span><span class="token punctuation">&gt;</span></span>お問い合わせ us<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/login"</span><span class="token punctuation">&gt;</span></span>ログイン<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span></code></pre><p>順序なしリストを使うことで、HTML4やXHTMLにも対応できる原始的なナビゲーション方法を呼び覚まし、かつ、慣習に沿ったナビゲーションを構築できます。リンクをリストでグループ化すれば、それらのリンクに共通の目的があることがアクセシブルに伝わります。さらに、CSSの読み込みに失敗しても、おなじみの箇条書きと下線が引かれた青いテキストを見れば、これがナビゲーション目的のものであるとわかります。</p><p>リストを用いるだけで、高齢者、古いデバイス、支援技術ユーザー、さらにはCSSの読み込みに失敗したユーザーにも使えるインクルーシブなものになっています。</p><p><img src="images/link_list.png" alt="アンダーラインが引かれたリンクの箇条書きリスト。ホーム、企業情報、製品情報、お問い合わせ、ログイン"/><br/><em>CSSが壊れていたり、存在しない状態でインターフェイスを見ることはしばしばありますが、これなら十分にナビゲーションブロックと認識できます。</em></p><p>このリストをnavigationランドマークロールを持った要素でくくると、さらにセマンティクスとふるまいを追加できます。スクリーンリーダーを使っていれば、ランドマークにさしかかって最初のリンクにフォーカスしたとき、多くの有用な情報を聞くことができるでしょう。最初に「ナビゲーション ランドマーク」と読み上げられた後、「リスト 5項目」と続き、最後に「home リンク」と読み上げられたとします。これにより、自分が今navigationランドマークにいること、そしてそこには全部で5つのリンクがあることがわかります。望むなら、すぐに最初のリンク先をたどることもできます。</p><p>それだけではありません。この<code>&lt;nav&gt;</code>（あるいは<code>role="navigation"</code>）ランドマークと<code>&lt;main&gt;</code>を組み合わせれば、ランドマークをたどりながら領域単位でページ内を移動できます――たとえば、NVDAスクリーンリーダーでは<em>D</em>キーを使います。また、NVDA、JAWS、VoiceOverでは、ランドマークを一覧表示することができ、それぞれの領域に直接行き来することができます。</p><ul><li><span class="pseudo-link">バナー</span><ul><li><span class="pseudo-link">ナビゲーション</span></li></ul></li><li><span class="pseudo-link">メイン</span></li><li><span class="pseudo-link">フッター</span></li></ul><p>はい、一覧にナビゲーションが含まれるナビゲーションメニューなんて、<em>まさに</em>メタですね。ともあれ、ページ領域の索引をスクリーンリーダーが自動生成してくれるのは助かります。よほどの信念がなければ、特定のエリアが見つかるよう運だのみでコンテンツ中を探し回りたいとは思わないでしょう。</p><h3>外観と配置</h3><p>人間の脳は、知覚した情報を<a href="https://en.wikipedia.org/wiki/Schema_%28psychology%29"><span class="link"><em>スキーマ</em></span></a>と呼ばれるパターンを用いて理解します。過去の経験によってスキーマが形成され、それに照らして現在の経験が評価されます。</p><p>スキーマは、<em>ものごとを理解するためのキャッシュ</em>の一種です。馴染みがあることを経験している限りは、さほど努力しなくても理解できます。逆に、まったく新しいことを経験する場合、キャッシュに頼ることができないため、知覚した情報をすべて評価しなければなりません。</p><p>デザインにおいては、特定のふるまいを期待させるように<em>見せる</em>ことで、ユーザーの認知のキャッシュを最大限に活用できるようにします。言い換えると、<a href="https://books.google.co.uk/books?id=QlduAgAAQBAJ&amp;source=gbs_book_similarbooks"><span class="link">ユーザーに考えさせるな</span></a>、ということです。これはよく知られたユーザビリティの原則ですが、あらためて取り上げる価値があります――特にインクルーシブデザインの文脈では、認知障害に対応しようとする際に重要になるからです。</p><p>サイト共通のナビゲーションランドマークの場合は、大きなリンクテキストが横並びになる、おなじみの形式が良いでしょう。これを各ページのヘッダーに置くのですが、メインコンテンツの上、可能な限り他のあらゆるものよりも前に配置しましょう。</p><p><img src="images/nav_page_layout.png" alt="ページのレイアウト図。上部のナビゲーションバーがハイライトされている。"/><br/><em>ナビゲーションバーを他の領域よりも前に配置。白文字、黒背景、このフォントにしろと言っているわけではありません。この配置と形状は、よく用いられるおなじみのものです。</em></p><h4>CSSによる配置</h4><p>サイトナビゲーションをページの一番上に置くのは、認識しやすさのためだけでなく、インタラクションのためでもあります。前述したように、キーボードユーザーはインタラクティブな要素を1つずつ順番にたどってページ内を移動します。ページナビゲーションが最上部にあれば、別のページに行くために現在のページを探し回る必要はなくなります。</p><p>そして実際に、ソースの順序と読み進める順序が同じであれば、それだけで問題なく使えるはずです。ただ残念なことに、私たちはつい作り込みすぎて無駄にややこしくしてしまうくせがあります。</p><p>2015年のFuture of Web Designカンファレンスで、私は<a href="https://twitter.com/LeonieWatson"><span class="link">レオニー・ワトソン（Léonie Watson）</span></a>のアクセシビリティ講座に参加しました。そのときの参加者のひとりがレオニーに相談を持ちかけました。あるプロトタイプのサイトナビゲーションにフォーカスが当てられず、その理由がわからないというのです。そして状況がわかりました。単に、サイトナビゲーションがソースの最下部にあったのです。30～40回<em>Tab</em>キーを押すとそこに到達し、最終的にはフォーカス状態になりました。</p><pre><code class=" language-markup">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- このページ内で最後のインタラクティブな要素 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span></code></pre><p>CSSのpositionプロパティの値を<code>absolute</code>または<code>fixed</code>にすれば、ソースの順序に関係なくビューポートの好きな場所に要素を表示できます。しかし、このやり方はキーボードユーザーの体験を損なう上、絶対配置された要素はリフローされなくなるという問題もあります。その結果、ビューポートやコンテンツのサイズが変わったときに、レイアウトに問題が生じることがあります。別の要素の裏側に要素が隠れたり、ビューポートの外側に要素がはみ出して見えなくなったりするのです。</p><p>きわめて例外的な場合を除き、原則として絶対配置は避けるべきです。絶対配置に頼ったモーダルダイアログを作るときは、細心の注意を払うとともに、さまざまなビューポートのサイズや拡大／縮小の倍率に対してテストしましょう。</p><h3>現在位置</h3><p>自分の行き先を知ることの半分は、自分がどこにいるかを知ることです。デパートやショッピングセンターのフロアマップに現在位置が表示されているのはそのためです。</p><p>同様に、親切なナビゲーションは、現在のページをハイライト表示します。つまり、今ユーザーが開いているページです。<code>&lt;nav&gt;</code>領域の中でも、現在のページへのリンクがどれなのかわかるようにすれば、サイトがより使いやすくなります。やり方さえ間違えなければ、このユーザビリティの向上策は、多様な設定やユーザーに対応したインクルーシブなものになり得ます。</p><h4>色だけで区別しない</h4><blockquote><p>色が、情報を伝える、動作を示す、反応を促す、又は視覚的な要素を判別するための唯一の視覚的手段になっていない。――<a href="https://www.w3.org/TR/WCAG20/#visual-audio-contrast"><span class="link">WCAG 2.0 1.4.1 色の使用</span></a></p></blockquote><p>典型的には、現在ページへのリンクは色を区別して目立たせますが、それでは色覚異常のユーザーが他のリンクと区別できないかもしれません。ベストなのは他の装飾と併用することで、テキストに下線を引くといった代替手段でも区別できるようにします。</p><pre><code class=" language-css"><span class="token selector">a.current-page </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span>
    <span class="token property">text-decoration</span><span class="token punctuation">:</span> underline<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> $highlight-color<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<div class="translator_note" id="translator_note1635"><h5>訳註</h5><p>このCSSで指定されている $highlight-color は、おそらくこのコードの外で定義されたSassの変数と思われます。</p></div>
<p><img src="images/nav_bar_underline.png" alt="ナビゲーションバー。「企業情報」リンクに現在位置を示す下線が引かれている。"/><br/><em>色合いによる区別が明らかでも、色覚異常のユーザーにとっては、図のようにごくわずかな濃淡の違い程度にしか見えないこともあります。色なしのWebページの見え方を知りたいなら、Macの場合は、<strong>［システム環境設定］→［アクセシビリティ］→［表示］</strong>で<strong>［グレイスケールを使用］</strong>をオンにします。</em></p><p>さらに大胆に、リンクを拡大したり、疑似要素を使って小さなポインターを表示したりしてもよいかもしれません。</p><pre><code class=" language-css"><span class="token selector">a.current-page </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> $highlight-color<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> scale(1.2)<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">a.current-page::after </span><span class="token punctuation">{</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span> -0.25rem<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 0.25rem<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url">url('images/pointer.svg')</span> center no-repeat<span class="token punctuation">;</span>
    <span class="token property">background-size</span><span class="token punctuation">:</span> auto 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p><img src="images/nav_bar_box.png" alt="ナビゲーションバー。「企業情報」リンクが白いボーダーのボックスとなり、少し拡大され、逆三角形のポインターが付与されている。"/></p><p>リンクテキストがはっきりと読めて、かつ、色が区別のための唯一の手段になっていないのであれば、どんな方法でもかまいません。</p><h4>スクリーンリーダーとキーボードサポート</h4><p>今のところ、現在のページのリンクを視覚以外で区別する標準的な方法はありません。次善の策を講じねばならないでしょう。私が書いた<a href="http://www.heydonworks.com/article/the-accessible-current-page-link-conundrum"><span class="link">「The Accessible Current Page Link Conundrum」</span></a>というブログ記事において、いくつかの可能性を検討したところ、コメント欄で生産的な議論が行われました。ここではその中でも特に良かったアイデアを紹介しましょう。</p>
<div class="translator_note" id="translator_note1662"><h5>訳註</h5><p>現在では、WAI-ARIA1.1で追加されたaria-current属性を使うのが標準的な方法と言えるでしょう。スクリーンリーダーの対応も最近になって進んできており、2017年5月にリリースされたNVDA 2017.2では、aria-current="page"を「現在のページ」、aria-current="location"を「現在の位置」と読みあげるようになりました。ここで紹介されている「The Accessible Current Page Link Conundrum」という記事では、aria-currentが提案中である旨が書かれています。原著が書かれた時点では、まだaria-currentは正式採用されていなかったものと思われます。</p><h6>参考</h6><ul><li><a href="http://www.w3.org/TR/2016/CR-wai-aria-1.1-20161027/#aria-current">Accessible Rich Internet Applications (WAI-ARIA) 1.1 - aria-current (state)</a></li><li><a href="https://www.nvaccess.org/files/nvda/releases/2017.2/nvda_2017.2_changes.html">What's New in NVDA</a></li></ul></div>
<p>最初に考える必要があるのは、リンクにフォーカスしたときにスクリーンリーダーが読み上げるテキストを指定する方法です。重要なのは、既存のリンクテキストをこのテキストで置き換えるのでは<em>なく</em>、リンクテキストの前か後に付け足すということです。視覚的には隠されながらスクリーンリーダーでは読み上げられる<code>&lt;span&gt;</code>を挿入して、「現在のページ」のような手がかりを含めるというアプローチがあります。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/"</span><span class="token punctuation">&gt;</span></span>ホーム<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/about"</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span>"visually-hidden"</span><span class="token punctuation">&gt;</span></span>現在のページ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span> 企業情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/products"</span><span class="token punctuation">&gt;</span></span>製品情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/contact"</span><span class="token punctuation">&gt;</span></span>お問い合わせ us<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/login"</span><span class="token punctuation">&gt;</span></span>ログイン<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span></code></pre><p>（<strong>注</strong>：CSSの<code>visually-hidden</code>classについては、4章「ブログ記事」を参照してください。）</p><p>このテキストが「現在のページ」でよいのか、「このページ」や「現在位置」とした方がよいのかは議論の余地がありますが、いずれにしても、かなり簡潔なものにするべきです。例では<code>&lt;span&gt;</code>を前に付け加えたので、スクリーンリーダーは「企業情報 現在のページ」ではなく「現在のページ 企業情報」と読み上げます。この「企業情報 現在のページ」は意味があいまいです。現在のページに<em>関する</em>説明へのリンクであるという誤解を与えます。</p>
<div class="translator_note" id="translator_note1679"><h5>訳註</h5><p>「企業情報」は原文では"About"です。"About Current Page"と読まれると「現在のページについて」と言っているように誤解されるということです。</p></div>
<p>あいまいさを軽減する、別のアプローチもあります。<a href="http://w3c.github.io/aria/aria/aria.html#aria-describedby"><span class="link"><code>aria-describedby</code></span></a>を使用する方法です。<code>aria-describedby</code>属性によって付け足される説明は、ひと呼吸置いてから読み上げられます。たとえば以下の例では、現在の（「企業情報」ページの）リンクにフォーカスしたときに、「企業情報（ひと呼吸置いて）現在のページ」と読み上げられます。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/"</span><span class="token punctuation">&gt;</span></span>ホーム<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/about"</span> <span class="token attr-name">aria-describedby</span><span class="token attr-value"><span class="token punctuation">=</span>"current"</span><span class="token punctuation">&gt;</span></span>企業情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/products"</span><span class="token punctuation">&gt;</span></span>製品情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/contact"</span><span class="token punctuation">&gt;</span></span>お問い合わせ us<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/login"</span><span class="token punctuation">&gt;</span></span>ログイン<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">hidden</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span>"current"</span><span class="token punctuation">&gt;</span></span>現在のページ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span></code></pre><p>いくつか注意点があります。</p><ul><li><code>aria-describedby</code>は<em>リレーションシップ属性</em>であり、説明される側の要素と説明する側の要素を<code>id</code>で関連づけます。説明する側の要素のテキストノードが、そのまま説明文として使われます。</li><li>HTML5の<code>hidden</code>属性を使い、視覚とスクリーンリーダーの両方から説明を隠しています。<code>display: none;</code>と似ていますが、こちらのほうが構文はすっきりします。隠されているにもかかわらず、リンクとの<em>関連づけは生きている</em>ため、リンクは「現在のページ」という説明とつながっており、フォーカスを受け取るとそれが読み上げられます。（本書の執筆時現在、Internet Explorerでは<code>hidden</code>はサポートされていませんが、スタイルシートに<code>[hidden] { display: none; }</code>を追加すれば無理やり使うことができます）。<div class="translator_note" id="translator_note1698"><h5>訳註</h5><p>Internet Explorer11ではhiddenがサポートされており、このようなスタイルシートの定義がなくてもhidden属性の指定された要素は非表示になります。</p></div></li>
<li>別ページに移動したときは、<code>aria-describedby="current"</code>属性を別のリンクに付け替えれば簡単に現在位置を変更できますし、classと同じように、スタイルを指定するフックとして使うこともできます。CSSに<code>[aria-describedby="current"]</code>と書くだけです。</li></ul><h4>冗長なリンクはスキップリンクに</h4><p>まだ話は終わっていません。企業情報ページ上では、現在のページを示すリンクはアクセシブルに識別できるようになりました。ただ、そのリンク先は企業情報ページ、つまり自分自身を指しているのです。そのため、リンクをクリックするとページがリロードされ、キーボードユーザーのフォーカスはドキュメントの一番上に飛ばされてしまいます。スクリーンリーダーユーザーには、<code>&lt;title&gt;</code>などのドキュメントレベルの情報や、ページに含まれるリンクの数といったメタ情報一式がもう一度読み上げられることになります。</p><p>自己参照リンクは冗長であるため、すべて取り除いたほうがよいというデザイナーもいます。そうすると、企業情報ページに残るのは以下になるでしょう。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/"</span><span class="token punctuation">&gt;</span></span>ホーム<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/products"</span><span class="token punctuation">&gt;</span></span>製品情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/contact"</span><span class="token punctuation">&gt;</span></span>お問い合わせ us<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/login"</span><span class="token punctuation">&gt;</span></span>ログイン<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span></code></pre><p>これは残念な体験になってしまいます。現在のページのリンクはコンテキストを示すためのものです。フロアマップに現在位置の目印があることを思い出しましょう。この目印がなければ、ユーザーは理不尽な間違い探しゲームへの参加を強制されるはめになります。</p><p>対処方法として、現在のページのリンクの<code>href</code>を削除する、または<code>&lt;a&gt;</code>全体を非インタラクティブ要素である<code>&lt;span&gt;</code>要素で置き換えるという提案を聞いたことがあります。どちらの方法も目が見えているユーザーには伝わります。しかし、スクリーンリーダーユーザーの多くはnavigationランドマーク内をリンクからリンクへ<em>Tab</em>キーでたどりながら確認していきます。現在のページの目印がフォーカスできないものであれば、あたかもそれが存在しないかのようにスキップされてしまいます。</p><p>私のお気に入りのやりかたは、現在のページのリンクの遷移先を、そのページのメイン領域にするというものです。こうすれば、ただページをリロードする代わりに、スキップリンクのように、navigationランドマークを飛ばしてコンテンツに移動できます。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/"</span><span class="token punctuation">&gt;</span></span>ホーム<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#main"</span><span class="token punctuation">&gt;</span></span>企業情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/products"</span><span class="token punctuation">&gt;</span></span>製品情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/contact"</span><span class="token punctuation">&gt;</span></span>お問い合わせ us<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/login"</span><span class="token punctuation">&gt;</span></span>ログイン<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span></code></pre><p>このリンクは、<code>[href="#main"]</code>属性セレクタを使って簡単にスタイルを設定できるだけでなく、支援技術にもふるまいが伝えられます。「ホーム」のリンクにフォーカスすると、「ホーム、リンク」と読み上げられるでしょう。次に「企業情報」のリンクにフォーカスを移すと、「企業情報、ページ内リンク」と読み上げられます。この時点で「ページ内リンク」と読み上げられているため、「現在のページ」という非表示の<code>&lt;span&gt;</code>は廃止してもよいといえます。<code>href</code>の値を変えるだけで、ふるまいとセマンティクスを結びつけることができました。</p>
<div class="translator_note" id="translator_note1730"><h5>訳註</h5><p>2017年8月現在、NVDAにはページ内リンクを区別して読み上げる機能はありません。JAWSでは、ここで書かれているように「ページ内リンク」 (英語版では "same page") と読みます。</p></div>
<p>この方法を提案してくれた<a href="https://twitter.com/danielgoransson?lang=en-gb"><span class="link">ダニエル・ゴランソン（Daniel Göransson）</span></a>の功績を称えます。ブログ記事のコメント欄の議論でこんな成果が出るとは、驚きました！</p><p>ただし、シングルページアプリケーションでこの方法を用いる場合は注意が必要です。新しくページ全体を読み込む動作をエミュレートしている場合、「ページ内リンク」という読み上げは結果としてウソになってしまい、ユーザーの混乱を招きます。シングルページアプリケーションにおいては<code>aria-describedby</code>を使うアプローチのほうが適しています。</p><h3>重複をなくす</h3><p><em>banner</em>ランドマークの中に、企業やプロジェクトのロゴとともにnavigationランドマークを置くことはよくあります。そのときの考え方の例を紹介しましょう。<code>&lt;header&gt;</code>要素に<code>banner</code> ARIAロールを明示的に指定していることに注意してください。<code>&lt;header&gt;</code>要素はページ内で複数使用できますが、bannerランドマークはひとつだけにすべきだとされています。どの<code>&lt;header&gt;</code>が当たりなのかを判断できる賢いブラウザもありますが、そうでない場合はこの指定が役立ちます。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation">=</span>"banner"</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/home"</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span>"images/logo.svg"</span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span>"ホーム"</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#main"</span><span class="token punctuation">&gt;</span></span>ホーム<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/about"</span><span class="token punctuation">&gt;</span></span>企業情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/products"</span><span class="token punctuation">&gt;</span></span>製品情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/contact"</span><span class="token punctuation">&gt;</span></span>お問い合わせ us<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/login"</span><span class="token punctuation">&gt;</span></span>ログイン<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span></code></pre><p>ユーザビリティの慣習に従うなら、ロゴ画像はホームページへのリンクも兼ねるべきで、ロゴがナビゲーションの役割を持つことになります。これは、ナビゲーションランドマーク内のひとつめのリンクと同じ役割です。この重複は無用な混乱を招きますし、同じ機能なのに<em>見た目</em>が異なるものがふたつあるということは、基本的なユーザビリティ原則に反しています。</p><p>ひとつの解決策は、ナビゲーションランドマークからホームへのリンクを削除することです。しかし、ナビゲーションランドマークにはキーボードショートカットを使って直接アクセスできるため、それ単体で完結していなければなりません。代わりに、このナビゲーションブロックのホームのリンクをロゴに変えて、不要になった<code>role="banner"</code>ランドマークの指定も取ってコンパクトにしてしまうこともできます。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#main"</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span>"images/logo.svg"</span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span>"ホーム"</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/about"</span><span class="token punctuation">&gt;</span></span>企業情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/products"</span><span class="token punctuation">&gt;</span></span>製品情報<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/contact"</span><span class="token punctuation">&gt;</span></span>お問い合わせ us<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"/login"</span><span class="token punctuation">&gt;</span></span>ログイン<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span></code></pre><p><strong>【MEMO】</strong>この例でもページ内リンクのテクニックを使っています。ホームページに<em>いる</em>状態を想定して、ロゴのリンクの遷移先を<code>#main</code>にしています。</p><p>画像をリンクにする場合は、代替テキスト（<code>alt</code>の値）には画像の説明ではなくリンク先を書くべきです。つまり、「プロジェクトのロゴ」では不十分です。「プロジェクトのホーム」か、単に「ホーム」とするのが適切です。</p><p>ホームページへのリンクをまとめることで、ナビゲーションをシンプルでわかりやすくできただけでなく、<code>Tab</code>キーを押す回数を減らし、スクリーンリーダーでの読み上げが繰り返されるのを防ぐこともできました。スクリーンリーダーユーザーが求めるすべての情報を入手できることは重要です。しかし冗長な情報はノイズであり、視覚的なものより無視しにくいのです。</p><p>レスポンシブデザインの場合は、<code>:first-child</code>擬似クラスを使ってこのロゴの入った要素を選択し、たとえば、ビューポートが狭い場合は改行して表示する、といったことも可能です。</p><pre><code class=" language-css"><span class="token atrule">@media (max-width: 20em) </span><span class="token punctuation">{</span>
    <span class="token selector">nav li:first-child </span><span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2>目次</h2><blockquote><p>「私はページ最上部にリンクがまとまっているのが好きです。多くのセクションで構成された長いページの場合、そうなっていると本当に助かります。そのページに何が書かれているかひと目で見当がつきます」
— Lea（<em><a href="http://rosenfeldmedia.com/books/a-web-for-everyone/"><span class="link">「A Web For Everyone」</span></a></em>の登場人物）</p></blockquote><p>Wikipediaのような、非常に長く詳細な記事を扱うリソースでは、昔から目次が使われます。以下のふたつのメリットがあるからです。</p><ul><li>長文のコンテンツを要約できる。</li><li>長文コンテンツの各セクションへのナビゲーションを提供できる。</li></ul><p>私が目次を好む最大の理由は、それがドロップダウン、プルダウン、ポップアップメニュー云々ではないという点です。1つの名前に決まっていないところからして、もうダメですね！ドロップダウン・サブメニュー（ここではそう呼ぶことにしました）も、目次と同様、関連するコンテンツへのリンクをグルーピングすることで問題を解決しようとしますが、いくつかの欠点があります。</p><p>まず、ナビゲーションを視界から消し、インタラクションによって初めてアクティブになる、ユーザーが気づくかどうかもわからないメニューの中に隠してしまうという点があります。また、インフォメーションアーキテクトにとっては、共通ページのセクションや階層構造に属さない独立ページを大量生産してしまいがちな状況になります。技術的にはドロップダウン・サブメニューをアクセシブルにすることもできますが、マウス、キーボード、タッチ操作を同時にサポートし、いずれの品質も保つのは簡単なことではありません。そこから展開するサブメニューは絶対配置する必要があるため、ビューポートの状況によってはレイアウト上の問題が生じます。JavaScript、CSS、あるいはその両方が使えないときのグレイスフルデグラデーションも面倒です。</p>
<div class="translator_note" id="translator_note1797"><h3>訳註</h3><p>目次が表示されていれば項目の階層構造やグルーピングがはっきり見えますが、折りたたんで隠してしまうと目につかなくなくなるため、階層構造やグルーピングにこだわらない設計をしてしまいやすくなる、という話と思われます。</p></div>
<p>何かをかろうじてインクルーシブにするよりも、ときには根本的な問題に目を向け、まったく別の解決策を考案したほうがよいこともあります――よりシンプルで、より堅牢なものを。目次は、ドロップダウン・サブメニューに対する解毒剤なのです。したがって、本書ではドロップダウン・サブメニューをひとつのパターンとして採用するつもりはありません。この件についてもっと詳しく知りたい方は、Nielsen Norman Groupの<a href="https://www.nngroup.com/articles/drop-down-menus-use-sparingly/"><span class="link">「Drop-Down Menus: Use Sparingly」</span></a>を参照してください。</p><h3>基本構造</h3><p>Wikipediaは、支援技術で見つけることができるように、「目次」という見出しに<code>&lt;h2&gt;</code> を使用しています。しかし、ページの各セクションにリンクしている目次は事実上のナビゲーションランドマークであるため、親要素に<code>role="navigation"</code>を指定すれば、Wikipediaよりもうまいやり方で目次を作成できます。それぞれのリンクの遷移先は、ページ内の各セクションの<a href="https://en.wikipedia.org/wiki/Fragment_identifier"><span class="link">フラグメント識別子</span></a>に設定します。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span>"toc"</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation">=</span>"navigation"</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>目次<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#history"</span><span class="token punctuation">&gt;</span></span>沿革<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#services"</span><span class="token punctuation">&gt;</span></span>業務内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#news"</span><span class="token punctuation">&gt;</span></span>ニュース<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#endorsements"</span><span class="token punctuation">&gt;</span></span>調達方針<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></code></pre><p><img src="images/table_of_contents.png" alt="枠線付きで背景色がグレーのボックス内の上部に「目次」という見出しがあり、その下に箇条書きのページ内リンクリストが配置されている。"/><br/><em>Webページの目次は、Wikipediaモデルが一般的です。シンプルな箇条書きのリンクリストを枠で囲んでいます。</em></p><h3>シーケンシャルフォーカスナビゲーション</h3><p>目次内のリンクは、同一ページ内のターゲットとなる要素の<code>id</code>を、<code>#services</code>のように、ドキュメントのURLにハッシュを付け加えた形で参照します。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span>"services"</span><span class="token punctuation">&gt;</span></span>業務内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span></code></pre><p>これらのターゲット（たいていは<code>&lt;section&gt;</code>や見出し）はフォーカスできない要素であることが多いのですが、ブラウザが採用している<em>シーケンシャルフォーカスナビゲーション</em>の仕組みでは、ターゲットの中または直後にある要素を<em>次の</em>フォーカス可能な要素とみなします。</p>
<div class="translator_note" id="translator_note1821"><h4>訳註</h4><p>「シーケンシャルフォーカスナビゲーション」は特別なものではなく、どのブラウザでも実装されている、Tabキーによるフォーカス移動のアルゴリズムを指します。</p><h5>参考</h5><ul><li><a href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation">Sequential focus navigation</a></li></ul></div>
<p>結果として、キーボードでナビゲートするユーザーは目次内のリンクをたどることができ、キーボードの機能でそのセクションに行けるという確信を持って、該当のセクションに移動することができます。</p><h4>ブラウザサポートの最大化</h4><p>シーケンシャルフォーカスナビゲーションが機能しないという<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=454172#c20"><span class="link">Chromeのバグ</span></a>が最近までありましたが、（ついに！）修正されました。Internet Explorerでシーケンシャルフォーカスナビゲーションを正しく動作させるためには、長年続く<code>hasLayout</code>バグを乗り越えなければなりません。幸い、ターゲットの<code>id</code>が設定されている要素に<code>tabindex="-1"</code>を付け加えるだけで解決します。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span>"services"</span> <span class="token attr-name">tabindex</span><span class="token attr-value"><span class="token punctuation">=</span>"-1"</span><span class="token punctuation">&gt;</span></span>業務内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span></code></pre><h4>リンクジャッキング</h4><p>ページ内リンクでターゲットセクションに移動する際、JavaScriptでスムーズスクロールするものを見かけることがあります。これを想定通りに動かすためには、リンクを押すとターゲットに即座にジャンプするという、ブラウザの標準的なふるまいを抑制する必要があります。<em>リンク</em>のふるまいが<em>スクロール</em>に置き換えられると、シーケンシャルフォーカスナビゲーションは行われなくなります。キーボードユーザーは立ち往生することになります。</p><p>標準のふるまいを奪ったわけですから、責任を持ってそのふるまいをエミュレートしてやる必要があります。つまり、このJavaScriptを修正するために、JavaScriptを使う必要があるわけです。JavaScriptでキーボード対応のインターフェイスを作るときにはよくあることですが、ユーザーが意図した場所に移動できるようにするために、明示的にフォーカスを管理しなければなりません。スムーズスクロールを実装する典型的な方法は、jQueryを使って<code>scrollTop</code>を操作することです。幸い、jQueryの<code>animate</code>メソッドではコールバックが使えるため、アニメーション終了後にターゲットとなる要素にフォーカスを当てることができます。</p><pre><code class=" language-javascript"><span class="token keyword">function</span> isSameResource<span class="token punctuation">(</span>urlOne<span class="token punctuation">,</span> urlTwo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> fragmentPattern <span class="token operator">=</span> <span class="token regex">/#.*$/</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> resourceOne <span class="token operator">=</span> urlOne<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>fragmentPattern<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> resourceTwo <span class="token operator">=</span> urlTwo<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>fragmentPattern<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> resourceOne <span class="token operator">==</span><span class="token operator">=</span> resourceTwo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> getFragmentTarget<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>id<span class="token punctuation">.</span>slice<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'#'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        id <span class="token operator">=</span> id<span class="token punctuation">.</span>slice<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// &lt;div id="{id}"&gt;または&lt;a name="{id}"&gt;を探す
</span>    <span class="token keyword">return</span> document<span class="token punctuation">.</span>getElementById<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
        <span class="token operator">||</span> document<span class="token punctuation">.</span>querySelector<span class="token punctuation">(</span><span class="token string">'a[name="'</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">'"]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 現在のページにあるすべてのフラグメントIDのリンクを処理する
</span>$<span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token string">'a[href*="#"]:not([href="#"])'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>isDefaultPrevented<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// このイベントはすでに他のイベントハンドラーによって処理されているかもしれない
</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isSameResource<span class="token punctuation">(</span>location<span class="token punctuation">.</span>href<span class="token punctuation">,</span> this<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> target <span class="token operator">=</span> getFragmentTarget<span class="token punctuation">(</span>this<span class="token punctuation">.</span>hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// フラグメントIDにジャンプするブラウザの動作を抑止する
</span>    <span class="token comment">// はじめにスクロールの動作をさせたいため
</span>    event<span class="token punctuation">.</span>preventDefault<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// ドキュメントをターゲット要素に向かって1秒かけてスムーズスクロールさせる
</span>    <span class="token comment">// Element.scrollIntoView() を使っていないのは、まだ広くサポートされていないため
</span>    $<span class="token punctuation">(</span><span class="token string">'html, body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>animate<span class="token punctuation">(</span>
        <span class="token punctuation">{</span> scrollTop<span class="token punctuation">:</span> $<span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span>offset<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// スクロールが完了してターゲットが表示された状態。
</span>            <span class="token comment">// 通常のリンクの場合と同様にブラウザにURLを更新させる 
</span>            window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash <span class="token operator">=</span> target<span class="token punctuation">.</span>id <span class="token operator">||</span> target<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>window.location.hash</code>で始まる行に注目してください。フォーカスを移した後に、このページのURLをハッシュフラグメントのついた形で更新しています。これで標準のふるまいが復活すると同時に、ユーザーはいつもどおり、ドキュメントのサブセクションをブックマークしたり共有したりできるようになります。このようにサブセクションを記録・再生する機能はWebの体験において不可欠であり、これがないと困るというユーザーもいるでしょう。</p><div class="translator_note" id="translator_note1865"><h5>訳註</h5><p>この実装には、ブラウザの「戻る」を押しても元の場所に戻れないという問題があります。戻れるようにするためには、pushStateを使うなどの追加の処理が必要です。</p></div>
<div class="translator_note" id="translator_note1867"><h5>訳註</h5><p>サブセクションをブックマークできると、途中まで読んだときにブックマークしておき、あとで続きから読むということができます。そういう使い方をする人もいて、それができないと困ることがあるという話です。</p></div>
<h3>ナビゲーションランドマークにラベルをつける</h3><p>この章では最初に、サイト内共通のナビゲーションランドマークを設置しました。それから、ページ内リンクのナビゲーションランドマークを追加して、現在のページの別の領域に移動できるようにしました。<code>banner</code>や<code>main</code>のように、1つのページで1回しか使えないランドマークもありますが、コンテンツが必要としているのであれば、ナビゲーションランドマークを複数使うことは認められています。</p><p>ただし、これは技術的に認められているという話であって、良好なユーザー体験になるかどうかはまた別の話です。ユーザーがこの2つのナビゲーションツールを活用するためには、どちらがどちらなのか区別できなければなりません。</p><p>視覚的に見分けるのは簡単で、スタイルや配置から判断できます。サイトナビゲーションは<code>&lt;main&gt;</code>の上に、目次は中にあるでしょう（ドキュメントの主要な <code>&lt;h1&gt;</code>見出しのすぐ下が好ましいでしょう。Microsoft Word文書でよく見かけるような感じです）。同様に、ページを上から下へブラウズしていったなら、スクリーンリーダーユーザーは最初にサイトナビゲーションに出くわすため、それが何か、何のためのものかは、ある程度わかります。前の例では「目次」という<code>&lt;h2&gt;</code>を取り上げましたが、このような見出しがあると、ユーザーが見出しジャンプの機能を使ってナビゲートする際に役立ちます。</p>
<div class="translator_note" id="translator_note1875"><h4>訳註</h4><p>実際には、Microsoft Wordの目次機能では好きな位置に目次を挿入することができます。Microsoft Wordで作ったかどうかに関係なく、文書一般の話として、最初の大見出しの下に目次が来ることが多いということでしょう。</p></div>
<p>しかし、4章「ブログ記事」の章でも取り上げましたが、スクリーンリーダーは、見出し、リンク、ランドマークを一覧表示する機能によって、独自のコンテンツ一覧を提供します。その際、見出しとリンクがコンテキストから外れても意味がわかるように、単独で理解できるようなラベルをつける必要があります。</p><p>見出しやリンクと違って、ランドマークにはラベルをつけるための独自の仕組みがありません。そのため、単純にロールだけで識別されることになります。したがって、2つのナビゲーションランドマークは次のようにリストされるでしょう。</p><ul><li>ナビゲーション</li><li>ナビゲーション</li></ul><p>大丈夫、心配はいりません。WAI-ARIAのグローバル属性である<code>aria-labelledby</code>リレーションシップ属性を使えば、既存の見出し要素を用いて補助的なラベルを付けることができます。次の例では、見出しの<code>id</code>を<code>aria-labelledby</code>の値として指定しているため、「目次」というテキストノード（<code>&lt;h2&gt;</code>の内容）がこの領域のラベルになります。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span>"toc"</span> <span class="token attr-name">aria-labelledby</span><span class="token attr-value"><span class="token punctuation">=</span>"contents-heading"</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span>"contents-heading"</span><span class="token punctuation">&gt;</span></span>目次<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#history"</span><span class="token punctuation">&gt;</span></span>沿革<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#services"</span><span class="token punctuation">&gt;</span></span>業務内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#office"</span><span class="token punctuation">&gt;</span></span>営業所<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#endorsements"</span><span class="token punctuation">&gt;</span></span>調達方針<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span></code></pre><p>見出しを使うことをおすすめするのは、スクリーンリーダーの見出しナビゲーションだけでなく、他のあらゆるユーザーにも明確に伝わるようになるからです。とはいえ、見出しがなければいけないというわけではありません。ランドマークに対して直接<code>aria-label</code>属性を指定することもできます。</p><pre><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span>"toc"</span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation">=</span>"目次"</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#history"</span><span class="token punctuation">&gt;</span></span>沿革<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#services"</span><span class="token punctuation">&gt;</span></span>業務内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#office"</span><span class="token punctuation">&gt;</span></span>営業所<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>"#endorsements"</span><span class="token punctuation">&gt;</span></span>調達方針<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span></code></pre><p>どちらの実装方法でも、以下の2つの効果が得られます。</p><ul><li>スクリーンリーダーユーザーがナビゲーションランドマーク内のリンクにフォーカスを移すと、コンテキストの情報に加えてラベルが読み上げられます。たとえば前の例の「沿革」のリンクにフォーカスすると、「<em>目次</em> ナビゲーション ランドマーク リスト 4項目 沿革 リンク」などと読み上げられます。</li><li>VoiceOver、NVDA、JAWSの要素リストでランドマークを表示すると、このナビゲーションランドマークは「目次 ナビゲーション」というラベルで表示され、区別することができます。</li></ul><h2>まとめ</h2><p>このパターンでは、HTMLの基本要素のひとつである箇条書きリストに対してプログレッシブ・エンハンスメントを施し、インクルーシブなサイト内やページ内のナビゲーションを作りました。その中で、論理的なソースの順序や、重複をなくす利点など、他の多くのパターンに応用できるデザイン原則についても触れました。また、JavaScriptを使ってスクロールのふるまいを変更する例では、キーボードユーザーも利用できるようにすること、グレイスフルデグラデーションによってスクリプトが使えない場合でも利用できるようにすることを担保しています。</p>
<div class="translator_note" id="translator_note1910"><h3>訳註</h3><p>この点については本文中に説明がありません。ここで紹介されているサンプルコードではまず、&lt;a href="#history"&gt;沿革&lt;/a&gt; のような通常のページ内リンクを用意し、そこにJavaScriptで機能を追加するというやり方をしています。そのため、スクリプト無効時には通常のページ内リンクとして機能します。以下のような実装を見かけることがありますが、hrefに直接JavaScriptを書くと、スクリプト無効時に何も起こらなくなってしまいます。</p><p/><p>&lt;a href="javascript:scrollTo('history')"&gt;沿革&lt;/a&gt;</p></div>
<h3>避けるべきこと</h3><ul><li>型破りだったり、探しにくかったりするメニューシステム。</li><li> 現在のページやセクションを色だけで区別する。</li><li>フォーカス管理を考えずにリンクのふるまいを乗っ取る。</li><li>複数の<code>&lt;nav&gt;</code>が存在するが一意のラベルがついていない。</li></ul></div>
</body></html>
